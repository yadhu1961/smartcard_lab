#include<stdio.h>
#include<stdint.h>
#include <string.h>

#define POLYMASK8 0xB8
uint8_t seeds[] = {164, 196, 150, 244, 191, 197, 34, 248, 233, 149, 89, 171, 63, 210,
117, 28, 158, 144, 223, 151, 64, 179, 147, 114, 131, 186, 67, 30, 135,
136, 115, 55, 182, 21, 78, 252, 219, 165, 112, 154, 162, 239, 190,
113, 46, 174, 185, 238, 10, 125, 120, 254, 194, 189, 220, 58, 84, 73,
99, 255, 118, 177, 138, 106, 47, 26, 181, 184, 90, 6, 43, 40, 133,
145, 107, 155, 22, 227, 232, 33, 85, 253, 111, 169, 38, 202, 217, 188,
104, 54, 2, 25, 24, 172, 160, 246, 166, 221, 142, 88, 31, 51, 132, 37,
103, 205, 70, 152, 187, 247, 18, 209, 216, 8, 100, 96, 82, 98, 75,
122, 231, 218, 17, 124, 204, 242, 148, 237, 167, 105, 130, 14, 79, 72,
215, 243, 32, 225, 241, 57, 249, 93, 153, 15, 251, 68, 129, 163, 91,
178, 39, 126, 213, 234, 56, 77, 81, 207, 95, 128, 23, 87, 228, 119, 5,
134, 60, 127, 97, 230, 110, 29, 42, 156, 137, 199, 59, 224, 69, 53,
175, 13, 226, 92, 45, 3, 173, 20, 250, 240, 141, 245, 11, 201, 116,
168, 146, 198, 143, 236, 19, 101, 212, 94, 52, 27, 1, 180, 12, 86, 80,
123, 83, 214, 71, 44, 183, 161, 66, 170, 73, 99, 255, 118, 177, 138,
106, 47, 26, 181, 184, 90, 6, 43, 40, 133, 145, 107, 155, 22, 227,
232, 33, 85, 253, 111, 169, 38, 202, 217, 188, 104, 54, 2, 25, 24,
172, 160, 246, 166, 221, 142, 88, 31, 51, 132, 37, 103, 205, 70, 152,
187, 247, 18, 209, 216, 8, 100, 96, 82, 98, 75, 122, 231, 218, 17,
124, 204, 242, 148, 237, 167, 105, 130, 14, 79, 72, 215, 243, 32};


uint8_t prngs[255*300] = {0};

uint8_t rand_lfsr()
{
    //Added for debugging purpose.
    //debug_led_toggle();
    // provided seed is the starting state for the LFSR
    uint8_t seed;
    // uint8_t lsb = seed & 1;   /* Get LSB (i.e., the output bit). */
    // seed >>= 1;                /* Shift register */
    // if (lsb)
    //     seed ^= POLYMASK8;      /* If the output bit is 1, add the mask. */
    for(int i = 0;i < 300;i++)
    {
        seed  = seeds[i];
        for(int j = 0;j < 160;j++)
        {

            uint8_t lsb = seed & 1;   /* Get LSB (i.e., the output bit). */
            seed >>= 1;                /* Shift register */
            if (lsb)
                seed ^= POLYMASK8; 
            prngs[i*256+j] = seed;
        }
    }
}


void main()
{

    printf("Hello generating random numbers\n");
    rand_lfsr();
    FILE *fp;
    fp = fopen("/home/yadu/smartcard/development/samples/prngs.dat","w");
    if(fp == NULL)
        printf("Failed to open the file\n");

    fwrite(prngs,1, 200*255, fp);
    fclose(fp);
}